<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>IndyHAX â€¢ Prototype</title>
<style>body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;max-width:900px;margin:40px auto;padding:0 16px}.card{border:1px solid #ddd;border-radius:12px;padding:18px;background:#fff}.muted{color:#666}input{padding:10px 12px;border-radius:10px;border:1px solid #ddd;width:min(600px,100%)}button{padding:10px 12px;border-radius:10px;border:1px solid #111;background:#111;color:#fff;margin-left:6px}pre{margin-top:12px;padding:12px;border-radius:10px;background:#f6f8fa;border:1px solid #e5e7eb;white-space:pre-wrap}</style>
</head><body>
<h1>IndyHAX CTF â€” Prototype</h1>
<div class="card">
  <p class="muted">This app merges JSON into a config object unsafely.</p>
  <p>
    <input id="j" placeholder='Try a JSON payload' />
    <button id="go">Merge</button>
  </p>
  <pre id="out"></pre>
</div>
<script>
  const out = document.querySelector('#out');
  const base = { user: 'guest', admin: false };
  function merge(target, src){
    for (const k in src){
      const v = src[k];
      if (v && typeof v === 'object' && !Array.isArray(v)){
        target[k] = target[k] || {};
        merge(target[k], v);
      } else {
        target[k] = v;
      }
    }
  }
  document.querySelector('#go').addEventListener('click', () => {
    const cfg = JSON.parse(JSON.stringify(base));
    const payload = JSON.parse(document.querySelector('#j').value || '{}');
    merge(cfg, payload);
    out.textContent = (cfg.admin === true) ? 'INDYHAX{prototype_pollution_turns_defaults_into_danger}' : 'Not admin.';
  });
</script>
</body></html>
